@using ABCo.Multicam.Server.Features;
@using ABCo.Multicam.Client.Blazor.Views.Features.Switcher
@using ABCo.Multicam.Client.ViewModels.Features;
@using ABCo.Multicam.Client.ViewModels.Features.Switcher;
@inherits AnimBasedVMBoundComponent<IProjectFeaturesVM>

<div class="featureView">
	<div class="options">
		<div class="connection firstOnARow btnLikeHighlight">
			<p>No devices synced</p>
		</div>

		<div class="strip">
			<a class="stripOption firstOnARow btnLikeHighlight" @onclick="e => VM.CreateFeature(new(e.ClientX, e.ClientY))">
				New Feature
				<img src="_content/ABCo.Multicam.Client.Blazor/img/icons/smallDownArrow.svg" />
			</a>
		</div>
	</div>

	@if (VM.MobileView != null)
	{
		<div class="mobileView @MobileViewClasses">
			<FeatureMobileView VM="VM.MobileView" />
		</div>
	}

	<ul class="items">
		@foreach (var item in VM.Items)
		{
			<li class="item">
				<FeatureViewItem VM="item" />
			</li>
		}
	</ul>
</div>

@code {
	// Animation code for mobile view menu
	string MobileViewClasses = "";

	public override async Task PerformAnimationAndDelay(string propertyName)
	{
		if (VM.MobileView != null)
		{
			if (propertyName == nameof(ProjectFeaturesVM.MobileView))
			{
				MobileViewClasses = "noInteraction slideOut";
				StateHasChanged();
				await Task.Delay(200);
			}
		}
		else MobileViewClasses = "";

		await Task.CompletedTask;
	}
}